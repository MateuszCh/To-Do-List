function saveZadania(){localStorage.setItem("json_str",JSON.stringify(zadania))}function makeListOfCategories(){listOfCategories=[];for(var e=0;e<zadania.length;e++)zadania[e]&&zadania[e].category&&listOfCategories.indexOf(zadania[e].category)<0&&listOfCategories.push(zadania[e].category);listOfCategories[0]&&listOfCategories.unshift("all")}function showListOfCategories(){makeListOfCategories(),categoryList.innerHTML="";for(var e=0;e<listOfCategories.length;e++){var t=document.createElement("li");t.classList.add("categories"),t.textContent=listOfCategories[e],categoryList.appendChild(t)}}function showTasksOfCategory(e){for(var t=0;t<taski.length;t++)if(taski[t].classList.remove("schow"),"all"!=e&&e){var a=taski[t].dataset.indexNumber;(!zadania[a].category||zadania[a].category&&zadania[a].category!=e)&&taski[t].classList.add("schow")}}function removePickedFromColors(){for(var e=0;e<colorsDivs.length;e++)colorsDivs[e].classList.contains("picked")&&(pickedColor=void 0,colorsDivs[e].classList.remove("picked"))}function hideList(e){"block"==e.style.display?(e.classList.add("zwinC"),setTimeout(function(){e.style.display="none",e.classList.remove("zwinC")},500)):"none"==e.style.display&&(e.style.display="block",e.classList.add("rozwinC"),setTimeout(function(){e.classList.remove("rozwinC")},500))}function Task(e,t,a,d,s,i){this.title=e,this.description=t,this.category=a,this.time=d,this.date=s,this.color=i,this.completed=!1}function clearForm(e){(window.matchMedia("(max-width: 1119px)").matches||e==editForm)&&(e.classList.add("zwinC"),setTimeout(function(){e.style.display="none",e.classList.remove("zwinC")},500));for(var t=document.getElementsByClassName("addFormInputs"),a=0;a<t.length;a++)t[a].value="";removePickedFromColors(),showTasks()}function changingSizeOfWindow(){var e=window.innerWidth;e>previousSize?window.matchMedia("(min-width: 1200px)").matches&&(addForm.style.display="block"):e<previousSize&&(window.matchMedia("(min-width: 1200px)").matches?addForm.style.display="block":(previousSize>1200&&e<1200||1200==previousSize)&&(addForm.style.display="none")),previousSize=e}function showTasks(){lista.innerHTML="",completedList.innerHTML="";for(var e=0;e<zadania.length;e++)if(void 0!=zadania[e]){var t=document.createElement("li");zadania[e].color&&(t.className=zadania[e].color),t.setAttribute("data-index-number",e),t.classList.add("listy");var a=document.createElement("input");a.type="checkbox",a.classList.add("completedCheckbox");var d="idy"+e;a.id=d;var s=document.createElement("label");s.setAttribute("for",d);var i=document.createElement("label");i.classList.add("task");var o=document.createElement("button");o.innerHTML='<i class="fa fa-trash deleteButton" aria-hidden="true"></i>',zadania[e].title?i.textContent=zadania[e].title:i.textContent=zadania[e].description;var n=document.createElement("label");n.textContent=zadania[e].time,n.classList.add("task");var r=document.createElement("label");r.textContent=zadania[e].category,r.classList.add("task");var l=document.createElement("label");l.textContent=zadania[e].date,l.classList.add("task"),t.appendChild(a),t.appendChild(s),t.appendChild(i),t.appendChild(r),t.appendChild(n),t.appendChild(l),t.appendChild(o),zadania[e].completed?(completedList.appendChild(t),a.checked=!0,t.classList.add("lisCom")):(lista.appendChild(t),t.classList.add("lisUn"))}updateHeadersForList(),updateCompletedTaskaCounter(),showListOfCategories()}function updateHeadersForList(){if(lista.firstChild){var e=document.getElementById("tasksHeader");e.classList.add("showHeader")}else{var e=document.getElementById("tasksHeader");e.classList.remove("showHeader")}if(completedList.firstChild){var e=document.getElementById("completedTasksHeader");e.classList.add("showHeader")}else{var e=document.getElementById("completedTasksHeader");e.classList.remove("showHeader")}}function updateCompletedTaskaCounter(){for(var e=0,t=0,a=0;a<zadania.length;a++)zadania[a]&&(e++,zadania[a].completed&&t++);completedTasksCounter.textContent="Completed tasks: "+t+"/"+e}function showEditForm(e){editTitle.value=e.title,editCategory.value=e.category,editContent.value=e.description,editTime.value=e.time,editData.value=e.date;for(var t=0;t<colorsDivs.length;t++)colorsDivs[t].classList.contains(e.color)&&colorsDivs[t].classList.add("picked")}function deleteAllCategoryTasks(e,t){for(var a=0;a<e.length;a++){var d=e[a].dataset.indexNumber;if(cat&&"all"!=cat){if(cat&&zadania[d].category==cat){e[a].classList.add("hide");var s=e[a];setTimeout(function(){t.removeChild(s)},500),delete zadania[d],saveZadania()}}else e[a].classList.add("hide"),setTimeout(function(){t.innerHTML=""},500),delete zadania[d],saveZadania()}setTimeout(function(){t.style.display="block"},501)}var addButton=document.getElementById("plus"),addFormCloseButton=document.getElementById("close"),editFormCloseButton=document.getElementById("closeEdit"),save=document.getElementById("save"),addTask=document.getElementById("addTask"),addForm=document.getElementById("addForm"),editForm=document.getElementById("editForm"),lista=document.getElementById("tasks"),completedList=document.getElementById("completedTasks"),lisy=document.getElementsByClassName("lisUn"),lisy2=document.getElementsByClassName("lisCom"),taski=document.getElementsByClassName("listy"),categoryList=document.getElementById("listOfCategories"),completedCheckbox=document.getElementsByClassName("completedCheckbox"),completedTasksCounter=document.getElementById("counter"),tasksHeader=document.getElementById("tasksHeaderH2"),completedTasksHeader=document.getElementById("completedTasksHeaderH2"),colorsDivs=document.querySelectorAll(".colors div"),zadania=[],listOfCategories=[],currentTaskObject,pickedColor,cat,previousSize=window.innerWidth,title=document.getElementById("title"),category=document.getElementById("category"),content=document.getElementById("content"),time=document.getElementById("time"),data=document.getElementById("data"),editTitle=document.getElementById("titleEdit"),editCategory=document.getElementById("categoryEdit"),editContent=document.getElementById("contentEdit"),editTime=document.getElementById("timeEdit"),editData=document.getElementById("dataEdit");window.addEventListener("resize",function(){changingSizeOfWindow()},!1),window.addEventListener("load",function(){var e=JSON.parse(localStorage.getItem("json_str"));e&&(zadania=e,showTasks())},!1),document.addEventListener("click",function(e){if(e.target&&e.target.classList.contains("categories")){var t=document.getElementsByClassName("markedCategory")[0];t&&t.classList.remove("markedCategory"),cat=e.target.textContent,e.target.classList.add("markedCategory"),showTasksOfCategory(cat)}if(e.target&&e.target.classList.contains("deleteButton")){e.target.parentNode.parentNode.classList.add("hide");var a=e.target.parentNode.parentNode.dataset.indexNumber;delete zadania[a],setTimeout(function(){showTasks()},500),void 0==zadania[zadania.length-1]&&zadania.pop(),saveZadania()}e.target&&e.target.classList.contains("completedCheckbox")&&(a=e.target.parentNode.dataset.indexNumber,e.target.checked?zadania[a].completed=!0:zadania[a].completed=!1,saveZadania(),showTasks(),showTasksOfCategory(cat)),e.target&&e.target.classList.contains("deleteAll")&&(e.target.parentNode.parentNode.parentNode.parentNode==document.getElementById("tasksHeader")||e.target.parentNode.parentNode==document.getElementById("tasksHeader")?deleteAllCategoryTasks(lisy,lista,!1):e.target.parentNode.parentNode.parentNode.parentNode!=document.getElementById("completedTasksHeader")&&e.target.parentNode.parentNode!=document.getElementById("completedTasksHeader")||deleteAllCategoryTasks(lisy2,completedList,!0),setTimeout(function(){updateHeadersForList(),updateCompletedTaskaCounter(),showListOfCategories()},501)),e.target&&e.target.classList.contains("task")&&(a=e.target.parentNode.dataset.indexNumber,currentTaskObject=a,editForm.style.display="block",editForm.classList.add("rozwinC"),setTimeout(function(){editForm.classList.remove("rozwinC")},500),showEditForm(zadania[a]))},!1);for(var t=0;t<colorsDivs.length;t++)colorsDivs[t].addEventListener("click",function(e){removePickedFromColors(),e.target.classList.add("picked"),pickedColor=e.target.className,pickedColor=pickedColor.slice(0,pickedColor.indexOf(" "))},!1);tasksHeader.addEventListener("click",function(){hideList(lista)},!1),completedTasksHeader.addEventListener("click",function(){hideList(completedList)},!1),addTask.addEventListener("click",function(e){if(e.preventDefault(),title.value||content.value){var t=category.value.toLowerCase(),a=new Task(title.value,content.value,t,time.value,data.value,pickedColor);zadania.push(a),clearForm(addForm),saveZadania()}},!1),addButton.addEventListener("click",function(){addForm.style.display="block",addForm.classList.add("rozwinC"),setTimeout(function(){addForm.classList.remove("rozwinC")},500)},!1),save.addEventListener("click",function(e){e.preventDefault();var t=editCategory.value.toLowerCase();zadania[currentTaskObject].title=editTitle.value,zadania[currentTaskObject].category=t,zadania[currentTaskObject].description=editContent.value,zadania[currentTaskObject].time=editTime.value,zadania[currentTaskObject].date=editData.value,pickedColor&&(zadania[currentTaskObject].color=pickedColor),clearForm(editForm),cat&&showTasksOfCategory(cat),saveZadania()},!1),addFormCloseButton.addEventListener("click",function(){clearForm(addForm),showTasksOfCategory(cat)},!1),editFormCloseButton.addEventListener("click",function(){clearForm(editForm),showTasksOfCategory(cat)},!1);